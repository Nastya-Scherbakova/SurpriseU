import React, { Component } from 'react';
import { Link, NavLink } from 'react-router-dom';
import 'scrollpos-styler';
import { Switch, Route, withRouter } from 'react-router-dom';
import { inject, observer } from 'mobx-react';
import Ionicon from 'react-ionicons';

@inject('userStore', 'authStore', 'presentsStore')
@withRouter
@observer
export class Menu extends Component {
    logOut = () => {
        this.props.authStore.logout()
    }
    render() {
        const { isUser } = this.props.userStore,
            path = this.props.location.pathname,
            { isFilter } = this.props.presentsStore;
        return <nav className={`menu container-fluid  fixed-top ${path == '/anketa' ? ' profile-menu ' : isFilter || ' sps sps--abv '}`}>
            <div className='content'>
                    <NavLink className="nav-brand" to={'/'}>   
                    <h1 className='main'>SurpriseU</h1>
                    </NavLink>
                    { path == '/' && <SearchInput /> }
                </div> 
                {
                isUser ? <div className="icons">
                    <NavLink className="navlink-no" to={'/profile'}><div className='nav-photo'>{UserImage}<img src='' /></div></NavLink>
                    <NavLink className="navlink-no" to={'/anketa'}><div className='nav-icon'>{Clipboard}</div></NavLink>
                    <NavLink className="navlink-no" to={'/login'}><div onClick={this.logOut.bind(this)} className='nav-icon'>{Exit}</div></NavLink>
                </div> : <div className="icons"><NavLink className="navlink-no" to={'/login'}><div className='nav-icon'>{Enter}</div> </NavLink></div>
                }
            </nav>;
    }
}


@inject('presentsStore')
@withRouter
@observer
class SearchInput extends Component {
    constructor(props) {
        super(props);
        this.state = {
            search: ''
        };
        this.openSearch = this.openSearch.bind(this);
        this.onChange = this.onChange.bind(this);
    }

    onChange(e) {
        this.setState({ search: e.target.value });
        this.props.presentsStore.searchInput(e.target.value);
    }

    openSearch = () => {
        this.search.focus();
        this.props.presentsStore.enableFilter();
    }
    render() {
        const { isFilter } = this.props.presentsStore;
        return <div className='d-flex align-items-center h-100 w-100'>
            <div className={`d-flex align-items-center search ${isFilter && ' open'} `}>

                <input type="search" ref={(input) => { this.search = input }} className="search-input"
                    value={this.state.search} placeholder="Пошук" onChange={this.onChange} />
            
                <Ionicon icon="ios-arrow-dropright" className='ios-right  nav-icon' onClick={this.openSearch} />
                <Ionicon icon="ios-search-outline" className='ios-search nav-icon' onClick={this.openSearch} />
            </div>
        </div >;
    }
}


const UserImage = <svg viewBox="0 0 53 53" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px">
    <path fill="#E7ECED" d={`M18.613,41.552l-7.907,4.313c-0.464,0.253-0.881,0.564-1.269,0.903C14.047,50.655,19.998,53,26.5,53
        c6.454,0,12.367-2.31,16.964-6.144c-0.424-0.358-0.884-0.68-1.394-0.934l-8.467-4.233c-1.094-0.547-1.785-1.665-1.785-2.888v-3.322
	c0.238-0.271,0.51-0.619,0.801-1.03c1.154-1.63,2.027-3.423,2.632-5.304c1.086-0.335,1.886-1.338,1.886-2.53v-3.546
	c0-0.78-0.347-1.477-0.886-1.965v-5.126c0,0,1.053-7.977-9.75-7.977s-9.75,7.977-9.75,7.977v5.126
	c-0.54,0.488-0.886,1.185-0.886,1.965v3.546c0,0.934,0.491,1.756,1.226,2.231c0.886,3.857,3.206,6.633,3.206,6.633v3.24
	C20.296,39.899,19.65,40.986,18.613,41.552z`} />
    <g>
        <path fill="#556080" d={`M26.953,0.004C12.32-0.246,0.254,11.414,0.004,26.047C-0.138,34.344,3.56,41.801,9.448,46.76
            c0.385-0.336,0.798-0.644,1.257-0.894l7.907-4.313c1.037-0.566,1.683-1.653,1.683-2.835v-3.24c0,0-2.321-2.776-3.206-6.633
		c-0.734-0.475-1.226-1.296-1.226-2.231v-3.546c0-0.78,0.347-1.477,0.886-1.965v-5.126c0,0-1.053-7.977,9.75-7.977
		s9.75,7.977,9.75,7.977v5.126c0.54,0.488,0.886,1.185,0.886,1.965v3.546c0,1.192-0.8,2.195-1.886,2.53
		c-0.605,1.881-1.478,3.674-2.632,5.304c-0.291,0.411-0.563,0.759-0.801,1.03V38.8c0,1.223,0.691,2.342,1.785,2.888l8.467,4.233
		c0.508,0.254,0.967,0.575,1.39,0.932c5.71-4.762,9.399-11.882,9.536-19.9C53.246,12.32,41.587,0.254,26.953,0.004z`} />
    </g>
</svg>;

const Exit = <svg viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px">
    <g>
        <path d={`M373.333,277.333c-5.888,0-10.667,4.779-10.667,10.667v106.667c0,17.643-14.357,32-32,32h-96V98.005
            c0-18.453-10.965-35.072-27.925-42.325l-80.128-34.347h204.053c17.643,0,32,14.357,32,32V160c0,5.888,4.779,10.667,10.667,10.667
				c5.888,0,10.667-4.779,10.667-10.667V53.333C384,23.936,360.064,0,330.667,0h-256c-0.853,0-1.621,0.299-2.432,0.491
				C70.635,0.32,69.035,0,67.392,0C42.005,0,21.333,20.672,21.333,46.059v367.936c0,18.453,10.965,35.072,27.925,42.325
				l121.173,51.947c5.76,2.475,11.883,3.733,18.176,3.733c25.387,0,46.059-20.672,46.059-46.059V448h96
				C360.064,448,384,424.064,384,394.667V288C384,282.112,379.221,277.333,373.333,277.333z M213.333,465.941
				c0,13.632-11.093,24.725-24.725,24.725c-3.371,0-6.656-0.661-9.749-1.984L57.664,436.736
				c-9.109-3.904-14.997-12.843-14.997-22.741V46.059c0-13.632,11.093-24.725,24.725-24.725c3.371,0,6.656,0.661,9.749,2.005
				l121.195,51.925c9.109,3.904,14.997,12.843,14.997,22.741V465.941z`}/>
			<path d={`M181.333,234.667c-5.888,0-10.667,4.779-10.667,10.667V288c0,5.888,4.779,10.667,10.667,10.667S192,293.888,192,288
            v-42.667C192,239.445,187.221,234.667,181.333,234.667z`}/>
			<path d={`M490.091,221.184c-0.107-0.384-0.085-0.811-0.235-1.195c-0.555-1.387-1.387-2.603-2.453-3.627l-63.872-63.872
            c-4.16-4.16-10.923-4.16-15.083,0c-4.16,4.16-4.16,10.923,0,15.083l45.76,45.76H266.667c-5.888,0-10.667,4.779-10.667,10.667
				s4.779,10.667,10.667,10.667h187.584l-45.803,45.803c-4.16,4.16-4.16,10.923,0,15.083c2.091,2.069,4.821,3.115,7.552,3.115
				c2.731,0,5.461-1.045,7.531-3.093l64-64c0.299-0.299,0.405-0.683,0.661-0.981c0.619-0.768,1.259-1.557,1.643-2.496
				c0.384-0.917,0.469-1.899,0.576-2.859c0.064-0.427,0.256-0.811,0.256-1.237C490.667,222.997,490.347,222.101,490.091,221.184z`}/>
		</g>
</svg>;

const Enter = <svg viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px">
    <g>
        <path d={`M173.781,280.469c-4.16,4.16-4.16,10.923,0,15.083c2.091,2.069,4.821,3.115,7.552,3.115c2.731,0,5.461-1.045,7.531-3.115
            l64-64c0.981-0.981,1.771-2.176,2.304-3.477c0.299-0.747,0.341-1.515,0.469-2.304c0.107-0.597,0.363-1.152,0.363-1.771
				c0-0.811-0.299-1.536-0.469-2.283c-0.128-0.576-0.128-1.195-0.363-1.749c-0.555-1.344-1.365-2.539-2.368-3.563l-63.936-63.936
				c-4.16-4.16-10.923-4.16-15.083,0c-4.16,4.16-4.16,10.923,0,15.083l45.76,45.781H32c-5.888,0-10.667,4.779-10.667,10.667
				S26.112,234.667,32,234.667h187.584L173.781,280.469z`}/>
			<path d={`M444.608,0c-1.643,0-3.243,0.32-4.843,0.491C438.955,0.299,438.187,0,437.333,0h-256C151.936,0,128,23.936,128,53.333
            V160c0,5.888,4.779,10.667,10.667,10.667s10.667-4.779,10.667-10.667V53.333c0-17.643,14.357-32,32-32h204.032l-80.107,34.325
				c-16.96,7.275-27.925,23.893-27.925,42.347v328.661h-96c-15.339,0-28.373-10.667-31.552-15.083l-0.448-123.627
				c-0.021-5.867-4.8-10.624-10.667-10.624c0,0-0.021,0-0.043,0c-5.888,0.021-10.645,4.821-10.624,10.709l0.491,124.309
				c-0.427,4.672,1.771,9.557,6.677,14.933c8.725,9.557,26.048,20.715,46.165,20.715h96v17.941
				c0,25.387,20.672,46.059,46.059,46.059c6.293,0,12.416-1.259,18.133-3.712l121.216-51.947
				c16.96-7.275,27.925-23.893,27.925-42.347V46.059C490.667,20.672,469.995,0,444.608,0z M469.333,413.995
				c0,9.899-5.888,18.837-14.997,22.72L333.12,488.661c-3.072,1.344-6.357,2.005-9.728,2.005c-13.632,0-24.725-11.093-24.725-24.725
				V98.005c0-9.899,5.888-18.837,14.997-22.72L434.88,23.339c3.072-1.344,6.357-2.005,9.728-2.005
				c13.632,0,24.725,11.093,24.725,24.725V413.995z`}/>
			<path d={`M330.667,234.667c-5.888,0-10.667,4.779-10.667,10.667V288c0,5.888,4.779,10.667,10.667,10.667
            s10.667-4.779,10.667-10.667v-42.667C341.333,239.445,336.555,234.667,330.667,234.667z`}/>
		</g>
</svg>;

const Clipboard = <svg viewBox="0 0 415.998 415.998" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px">
    <g>
        <g>
            <circle cx="208.239" cy="48" r="12" />
        </g>
    </g>
    <g>
        <g>
            <path d={`M367.998,95.999c0-17.673-14.326-32-31.999-32h-44.424c-5.926-6.583-13.538-11.62-22.284-14.136
                c-7.367-2.118-13.037-7.788-15.156-15.155C248.37,14.664,229.897,0,207.998,0c-21.898,0-40.37,14.663-46.134,34.706
			c-2.122,7.376-7.806,13.039-15.182,15.165c-8.736,2.518-16.341,7.55-22.262,14.128H79.999c-17.674,0-32,14.327-32,32v287.999
			c0,17.673,14.326,32,32,32c73.466,0,163.758,0,256,0c17.674,0,32-14.327,32-32C367.999,293.119,367.998,206.096,367.998,95.999z
			 M128,95.741c0.11-14.066,9.614-26.606,23.113-30.496c12.71-3.662,22.477-13.426,26.127-26.116
			C181.157,25.51,193.805,16,207.998,16c14.194,0,26.842,9.51,30.758,23.13c3.652,12.698,13.413,22.459,26.111,26.11
			c13.618,3.917,23.13,16.566,23.13,30.758v16H128V95.741z M335.999,399.998c-85.455,0-170.77,0-256,0c-8.823,0-16-7.178-16-16
			V95.999c0-8.822,7.177-16,16-16h34.742c-1.73,4.892-2.698,10.143-2.74,15.617v32.383h191.998v-32c0-5.615-0.992-10.991-2.764-16
			h34.764c8.822,0,15.999,7.178,15.999,16c0,45.743-0.001,260.254,0.002,287.999C351.999,392.82,344.822,399.998,335.999,399.998z`}
			/>
	</g>
    </g>
    <g>
        <g>
            <rect x="159.999" y="176" width="144" height="16" />
        </g>
    </g>
    <g>
        <g>
            <rect x="159.999" y="224" width="144" height="16" />
        </g>
    </g>
    <g>
        <g>
            <rect x="159.999" y="272" width="144" height="16" />
        </g>
    </g>
    <g>
        <g>
            <rect x="159.999" y="320" width="144" height="16" />
        </g>
    </g>
    <g>
        <g>
            <circle cx="119.999" cy="184" r="8" />
        </g>
    </g>
    <g>
        <g>
            <circle cx="119.999" cy="232" r="8" />
        </g>
    </g>
    <g>
        <g>
            <circle cx="119.999" cy="280" r="8" />
        </g>
    </g>
    <g>
        <g>
            <circle cx="119.999" cy="328" r="8" />
        </g>
    </g>
</svg>;
